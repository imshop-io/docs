# Приглашение в программу лояльности

{% hint style="danger" %}
**IMSHOP Retail Protocol (IRP)** является объектом интеллектуальной собственности ООО «АЙ ЭМ СОЛЮШНЗ» (IMSHOP) и защищён как объект авторского права. Свидетельство о депонировании произведения № 023-014461 от 16 января 2023 г. подтверждает исключительные права ООО «АЙ ЭМ СОЛЮШНЗ» на данные технологии.

IMSHOP Retail Protocol создан по заказу ООО «АЙ ЭМ СОЛЮШНЗ». Использование IMSHOP Retail Protocol допустимо только при взаимодействии с ООО "АЙ ЭМ СОЛЮШНЗ" и наличии действующего лицензионного договора. Более подробно можно ознакомиться [здесь](../../api-license.md).
{% endhint %}

![](<../../.gitbook/assets/Screenshot 2022-10-14 at 12.22.14.png>)

{% hint style="danger" %}
Дополнительные интеграции вводятся в эксплуатацию после завершения основных интеграций:

* [Оформление заказа](../../osnovnye-integracii/oformlenie-zakaza.md)
* [Доставки](../../osnovnye-integracii/dostavki.md)
* [Оплаты](../../osnovnye-integracii/oplaty.md)

Для подключения дополнительных интеграций обратитесь к вашему менеджеру в IMSHOP.IO
{% endhint %}

Чтобы понять что по этой ссылке перешел клиент и нужно начислять бонусы, при переходе по ссылке и в дальнейшем первом открытии приложении, приложение запоминает реферальный код который был зашит в ссылке, и при регистрации в приложении, мы отправляем в webhook поле referralCode с этим кодом.

## Запрос

`APP SERVER → INFRASTRUCTURE`

{% hint style="warning" %}
От вас потребуется URL, на который наш сервер будет слать **POST**-запрос. Да, мы _запрашиваем_ данные через _POST_, а не через _GET_.
{% endhint %}

В вашу систему будут приходить вот такие данные:

```json
{
    "userIdentity": {
        "userId": "123456"
    }
}
```

* **`userId`** — идентификатор пользователя (обязательное поле), полученный от системы клиента на этапе авторизации

#### Ответ

```json
{
  "success": true,
  "url": "https://some.url/link",
  "referralCode": "AAA123",
}
```

* **`url`**  - ссылка для приглашения друга&#x20;
* **`referralCode`** - реферальный код (необязательно). Если не передали, то будем показывать и отправлять id пользователя

{% hint style="info" %}
Следует помнить, что этот запрос будет приходить из нашего доверенного, [авторизованного](broken-reference) сервера; это — не публичный API.
{% endhint %}
