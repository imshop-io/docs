# Кнопка "повторить оплату"

{% hint style="danger" %}
Мы работаем только через **POST**-запросы
{% endhint %}

### Отображение статуса платежа и списания средств в приложении (кнопка "повторить оплату")

{% hint style="warning" %}
Если у вас используется двухэтапная оплата, то необходимо проводить списание замороженных средств в момент поступления подтверждения о заморозке от платежного шлюза, а не в момент получения уведомления от IMSHOP.IO



Запрос **`capture`** используется для уведомления, что пользователь успешно ушел с экрана оплаты на стороне эквайринга. Если пользователь не уходил с экрана оплаты, запрос **`capture`** не будет отправлен.\
\
Списание по запросу **`capture`** от IMSHOP.IO рекомендуется только в случаях, когда платежный шлюз не поддерживает уведомления об успешной заморозке средств.
{% endhint %}

### **Пример запроса**

```json
{
    "command": "capture",
    "paymentMethodId": "sberbank/card",
    "paymentId": "7d0567f9-bf37-4e84-9580-86b68b8a0e81"
}
```

* **`command`** - запрос на проведение платежа и проверку факта списания (`capture`)
* **`paymentMethodId`** - выбранный покупателем способ оплаты. Берется из ответа [webhook получения способов оплат](../../../osnovnye-integracii/oplaty.md)
* **`paymentId`** - Идентификатор платежа

### **Пример ответа**

```json
{
    "success": true,
    "paymentId": "7d0567f9-bf37-4e84-9580-86b68b8a0e81",
    "paymentCaptured": true
}
```

* **`success`** - флаг успеха **`true`** / **`false`**
* **`paymentId`** - идентификатор платежа
* **`paymentCaptured`** - деньги успешно списаны
* **`error`** - текст ошибки если **`success`** = **`false`**
