# Список «Маркетинговые акции»

{% hint style="danger" %}
**IMSHOP Retail Protocol (IRP)** является объектом интеллектуальной собственности ООО «АЙ ЭМ СОЛЮШНЗ» (IMSHOP) и защищён как объект авторского права. Свидетельство о депонировании произведения № 023-014461 от 16 января 2023 г. подтверждает исключительные права ООО «АЙ ЭМ СОЛЮШНЗ» на данные технологии.

IMSHOP Retail Protocol создан по заказу ООО «АЙ ЭМ СОЛЮШНЗ». Использование IMSHOP Retail Protocol допустимо только при взаимодействии с ООО "АЙ ЭМ СОЛЮШНЗ" и наличии действующего лицензионного договора. Более подробно можно ознакомиться [здесь](../../../api-license.md).
{% endhint %}

### Формат ответа при пересчете корзины

{% hint style="info" %}
Доп. поле **`promoGroups`** передаётся в стандартном ответе расчета корзины
{% endhint %}

* **`promoGroups`** - список групп маркетинговых акций, доступных в корзине на выбор\
  (в каждой группе их может быть несколько)
  * **`id`** - идентификатор акции
  * **`name`** - название акции
  * **`sumsWithBonuses`** - суммируется ли акция с бонусами. Если покупатель выберет акцию с этим флагом в значени&#x438;**`false`**, ему будет доступна опция **Получить или потратить бонусы** для отказа от участия в акциях.
  * **`gifts`** - список товаров, предлагаемых в виде подарка (не на выбор). Если покупатель примет подарок, то эти товары будут добавлены в корзину.
    * **`id`** - идентификатор товарного предложения
    * **`quantity`** - количество единиц товара
  * **`giftOptions`** - список товаров, предлагаемых в виде подарка на выбор. Если покупатель примет подарок, то товар из этого списка будет добавлен в корзину.
    * **`id`** - идентификатор товарного предложения
    * **`quantity`** - количество единиц товара
  * **`giftOptionsLimit`**- количество вариантов подарков, доступных пользователю на выбор (используется, если списо&#x43A;**`giftOptions`** заполнен, **`1`** по умолчанию)
  * **`discount`**- сумма скидки на всю корзину, применяемая при выборе акции (заменяет значение **`discount`** основного тела ответа и не суммируется с ним)

{% hint style="success" %}
#### Пример: две группы акций, в первой доступен один из двух подарков на выбор + скидка; во второй два подарка, автоматически добавляемых к заказу (пользователю не нужно ничего выбирать)
{% endhint %}

```json
{
  ...
  "promoGroups": [
    [
      {
        "id": "promo-id-1",
        "name": "Gift selection promo",
        "sumsWithBonuses": false,
        "giftOptions": [
          {
            "id": "8252",
            "quantity": 2
          },
          {
            "id": "13654",
            "quantity": 1
          }
        ],
        "giftOptionsLimit": 1
      },
      {
        "id": "promo-id-1-discount",
        "name": "Discount promo",
        "sumsWithBonuses": true,
        "discount": 1000
      }
    ],
    [
      {
        "id": "promo-id-2",
        "name": "Simple gifts promo",
        "sumsWithBonuses": true,
        "gifts": [
          {
            "id": "13654",
            "quantity": 1
          },
          {
            "id": "8252",
            "quantity": 2
          }
        ]
      }
    ]
  ]
  ...
}
```

### Формат запроса после выбора акции

{% hint style="info" %}
Доп. поле **`promoGroup`** передаётся в запросы корзины, доставок и оплат
{% endhint %}

Поля каждой акции в группе:

* **`id`** - идентификатор акции
* **`gifts`** - список товаров, выбранных в качестве подарка. Если акция подразумевает только скидку или выбор подарка пользователю недоступен, это поле не будет заполнено
  * **`id`** - идентификатор товарного предложения
  * **`quantity`** - количество единиц товара

{% hint style="success" %}
#### Пример: из акций, перечисленных выше, выбрана группа с одним товаром из предложенных двух (`giftOptionsLimit=1`, но конкретный артикул добавляется в количестве двух штук, т.к. в `giftOptions` для него было получено `quantity=2`) + скидка 1000р
{% endhint %}

```json
{
  ...
  "promoGroup": [
    [
      {
        "id": "promo-id-1",
        "gifts": [
          {
            "id": "8252",
            "quantity": 2
          }
        ]
      },
      {
        "id": "promo-id-1-discount"
      }
    ]
    ...
}
```

{% hint style="success" %}
#### Пример: из акций, перечисленных выше, выбрана группа, автоматически добавляющая два товара (первый артикул в одном экземпляре, второй - в двух, т.к. в `gifts` для него было получено `quantity=2`)
{% endhint %}

```json
{
  ...
  "promoGroup": [
    [
      {
        "id": "promo-id-2"
      }
    ]
    ...
}
```

### Известные проблемы

{% hint style="warning" %}
В предыдущих версиях вебхуков использовалось поле **`selectedPromo`**(deprecated). Обращаться к информации, содержащейся в нём, не рекомендуется. В будущих версиях оно будет удалено.
{% endhint %}
