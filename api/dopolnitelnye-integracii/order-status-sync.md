# Синхронизация статусов заказов

## Статус заказа изменяется со стороны сайта или других систем клиента

{% hint style="info" %}
**Данная интеграция является API. То есть запрос идет в систему Imshop.**

Для получения URL обратитесь к вашему менеджеру
{% endhint %}



{% hint style="danger" %}
Дополнительные интеграции вводятся в эксплуатацию после завершения основных интеграций:

* [Оформление заказа](../oformlenie-zakaza.-dostavki-oplaty/order.md)
* [Доставки](../oformlenie-zakaza.-dostavki-oplaty/deliveries.md)
* [Оплаты](../oformlenie-zakaza.-dostavki-oplaty/payments.md)

Для подключения дополнительных интеграций обратитесь к вашему менеджеру в IMSHOP.IO
{% endhint %}

{% hint style="info" %}
Вам также надо будет передать в IMSHOP.IO идентификаторы и описания всех возможных статусов заказа в вашей системе
{% endhint %}

## Запрос

### Описание формата

* **`id`** - Номер заказа в системе клиента или в IMSHOP.IO \(рекомендуем использовать UUID идентификатор IMSHOP.IO. Использовать внутренний ID рекомендуется только если заказ был разбит на несколько на стороне клиента\)
* **`code`** - Идентификатор статуса заказа в системе клиента
* **`message`** - опционально, статус заказа в текстовом виде. Этот текст увидит покупатель в приложении
* **`trackingUrl`** - опционально, ссылка на страницу отслеживания почтового или курьерского отправления

### Пример

```javascript
{
    "id": "05671863",
    "code": "packed",
    "message": "Готов к выдаче",
    "trackingUrl": "https://www.cdek.ru/ru/tracking?order_id=1234567890"
}
```

## Ответ

### Описание формата

* **`success`** - Флаг успешного выполнения
* **`internalId`** - Номер заказа в системе клиента
* **`uuid`** - UUID заказа в системе IMSHOP.IO
* **`newStatus`** - Инедтификатор нового статуса заказа в системе клиента
* **`imshopStatus`** - Инедтификатор нового статуса заказа в IMSHOP.IO
* **`message`** - Текстовый статус заказа

### Пример ответа

```javascript
{
    "success": true,
    "internalId": "05671863",
    "uuid": "cfe64e76-dbc4-4f0f-b9d1-7423aeb6f195",
    "newStatus": "packed",
    "imshopStatus": "ready_for_pickup",
    "message": "Готов к выдаче"
}
```

## Статус заказа изменяется со стороны мобильного приложения \(в разработке\)

{% hint style="info" %}
Сценарий изспользования, когда покупатель нажимает на кнопку отмены заказа в самом приложении
{% endhint %}

## Запрос

### Описание формата

* **`uuid`** - Идентификатор заказа в системе IMSHOP.IO
* **`internalId`** - Идентификатор статуса заказа в системе клиента
* **`reason`** - опционально, причина отмены, если пользователь предоставил

### Пример

```javascript
{
    "uuid": "f5315818-cccc-4444-aaaa-31b6aebceb54",
    "internalId": "12345",
    "reason": "Не дозвонились, купил в другом магазине"
}
```

## Ответ

### Описание формата

* **`success`** - Флаг успешного выполнения
* **`newStatus`** - опционально, идентификатор нового статуса заказа в системе клиента,  чтобы он сработал, должна быть настроена таблица соответствия статусов заказов между системой IMSHOP и системой клиента, для этого Вам надо будет передать в IMSHOP.IO идентификаторы и описания всех возможных статусов заказа в вашей системе
* **`newMessage`** - опционально, новый текстовый статус заказа

### Пример ответа

```javascript
{
    "success": true,
    "newStatus": "cancelled",
    "newMessage": "Отменен"
}
```

