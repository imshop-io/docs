# Получение и редактирование данных учётной записи

![](../../.gitbook/assets/image%20%282%29.png)

### Запрос данных пользователя по идентификатору

`APP SERVER → INFRASTRUCTURE`

{% hint style="info" %}
От вас потребуется URL, на который наш сервер будет слать **POST**-запрос. Да, мы _запрашиваем_ данные через _POST_, а не через _GET_.
{% endhint %}

В вашу систему будут приходить вот такие данные:

```javascript
{
    "userIdentifier": "71234567890"
}
```

* `userIdentifier` — идентификатор пользователя \(обязательное поле\), полученный от системы клиента на этапе авторизации

Идентификатор пользователя — это номер телефона, адрес email, или любой другой идентификатор \(например, логин\), как договоримся. В случае с номером телефона мы присылаем только цифры, через семёрку.

**Ответ:**

```javascript
{
    "user": {
        "id": "71234567890",
        "name": "Иванов Иван",
        "phone": "71234567890",
        "email": "ivanov@mail.com",
        "bonuses": 10000,
        "segments": ["registered", "loyal"],
        "age": 35,
        "gender": "male",
        "cardNumber": "456123789"
    }
}
```

* `id` — идентификатор пользователя \(обязательное поле\)
* `name` — имя пользователя, достаточное для оформления заказа \(необязательное поле\)
* `phone` — номер телефона пользователя \(необязательное поле\)
* `email` — адрес электропочты пользователя \(необязательное поле\)
* `bonuses` — количество бонусов на счету пользователя \(необязательное поле\)
* `segments` — сегменты, к которым относится пользователя \(необязательное поле\)
* `cardNumber` — номер карты лояльности \(необязательное поле\)
* … и любые другие поля.

В случае, если пользователь новый, и информации по нему никакой нет — допустимо присылать пустые поля \(все, кроме `id`\), или не присылать их вовсе.

{% hint style="info" %}
Следует помнить, что этот запрос будет приходить из нашего доверенного, [авторизованного](../general.md#avtorizaciya-api) сервера; это — не публичный API.
{% endhint %}

**Ошибка: невозможно получить информацию**

```javascript
{
    "error": {
        "message": "Пользователя с таким идентификатором более не существует"
    }
}
```

* `message` — сообщение для пользователя, описывающее проблему \(обязательное поле\)

Как правило, такая ошибка возникать не будет, т.к. запрос данных пользователя по идентификатору будет происходить только для заранее авторизованных пользователей.

### Обновление данных пользователя по идентификатору

`APP SERVER → INFRASTRUCTURE`

{% hint style="info" %}
От вас потребуется URL, на который наш сервер будет слать **PATCH**-запрос.
{% endhint %}

В вашу систему будут приходить вот такие данные:

```javascript
{
    "userIdentifier": "71234567890",
    "name": "Ваня",
    "phone": "70987654321",
    "email": "vanya@yahoo.com"
}
```

* `user_identifier` — идентификатор пользователя \(обязательное поле\)
* `name` — новое имя пользователя \(необязательное поле\)
* `phone` — новый телефон пользователя \(необязательное поле\)
* `email` — новый адрес электропочты пользователя \(необязательное поле\)

Если то или иное поле в запросе отсутствует — соответствующую информацию обновлять не нужно.

{% hint style="info" %}
Вероятно, что в вашей системе нельзя править ключевые поля учётной записи. Например, номер телефона. 

Сообщите нам, мы запретим редактирование этих полей на своей стороне.
{% endhint %}

**Ответ:**

```javascript
{
    "user": {
        "id": "71234567890",
        "name": "Иванов Иван",
        "phone": "71234567890",
        "email": "ivanov@mail.com",
        "bonuses": 10000,
        "segments": ["registered", "loyal"],
        "age": 35,
        "gender": "male",
        "cardNumber": "456123789"
    }
}
```

* `id` — идентификатор пользователя \(обязательное поле\)
* `name` — имя пользователя, достаточное для оформления заказа \(необязательное поле\)
* `phone` — номер телефона пользователя \(необязательное поле\)
* `email` — адрес электропочты пользователя \(необязательное поле\)
* `bonuses` — количество бонусов на счету пользователя \(необязательное поле\)
* `segments` — сегменты, к которым относится пользователя \(необязательное поле\)
* `cardNumber` — номер карты лояльности \(необязательное поле\)
* … и любые другие поля.

Ваша система является \(единственным\) источником правдивой информации о пользователях. Поэтому мы ждём полную информацию о пользователе в ответ на запрос обновления. Только вы можете решить, принимать обновления или нет.

**Ошибка: невозможно обновить информацию**

```javascript
{
    "error": {
        "message": "Вы не можете присвоить имя Наполеона"
    }
}
```

* `message` — сообщение для пользователя, описывающее проблему \(обязательное поле\)

